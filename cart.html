<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Cart</title>
<style>
body { font-family: Arial; background:#f6f1e7; padding:20px; }
.box { background:#fff; padding:20px; border-radius:10px; max-width:600px; margin:auto; }
.row { display:flex; justify-content:space-between; margin-bottom:8px; }
</style>
</head>

<body>

<div class="box">
  <h2 id="table"></h2>
  <div id="items"></div>
  <h3 id="total"></h3>
  <button onclick="placeOrder()">Place Order</button>
</div>

<script>
document.addEventListener("DOMContentLoaded", () => {

  const params = new URLSearchParams(location.search);
  const table = params.get("table") || "1";
  const CART_KEY = `cart_table_${table}`;
  const KITCHEN_KEY = "kitchen_orders";

  document.getElementById("table").innerText = "Table " + table;

  const cart = JSON.parse(localStorage.getItem(CART_KEY)) || {};
  let total = 0;

  const itemsDiv = document.getElementById("items");

  Object.values(cart).forEach(i => {
    total += i.price * i.qty;
    itemsDiv.innerHTML += `
      <div class="row">
        <span>${i.name} × ${i.qty}</span>
        <span>₹${i.price * i.qty}</span>
      </div>
    `;
  });

  document.getElementById("total").innerText = "Total ₹" + total;

  window.placeOrder = () => {
    const orders = JSON.parse(localStorage.getItem(KITCHEN_KEY)) || [];
    orders.push({ table, cart, total, time: new Date().toLocaleString() });
    localStorage.setItem(KITCHEN_KEY, JSON.stringify(orders));
    localStorage.removeItem(CART_KEY);
    alert("Order placed");
    location.href = `index.html?table=${table}`;
  };
});
</script>

</body>
</html>
