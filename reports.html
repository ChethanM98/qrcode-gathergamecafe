<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Reports</title>

<script>
(function () {
  const auth = localStorage.getItem("admin_auth");
  const time = localStorage.getItem("admin_auth_time");

  if (!auth || !time || Date.now() - time > 30 * 60 * 1000) {
    localStorage.removeItem("admin_auth");
    localStorage.removeItem("admin_auth_time");
    location.href = "admin-login.html";
  }
})();
</script>

<style>
body {
  font-family: Arial;
  background:#f6f1e7;
  padding:20px;
}
.box {
  background:#fff;
  padding:20px;
  border-radius:10px;
  max-width:700px;
  margin:auto;
}
.row {
  display:flex;
  justify-content:space-between;
  margin:6px 0;
}
button {
  padding:10px;
  margin:6px 0;
  width:100%;
}
</style>
</head>

<body>

<div class="box">
  <h2>ðŸ“Š Reports</h2>

  <button onclick="daily()">ðŸ“… Daily Report</button>
  <button onclick="monthly()">ðŸ“† Monthly Report</button>

  <div id="report"></div>

  <button onclick="logout()">Logout</button>
</div>

<script>
const CLOSED_KEY = "closed_bills";
const reportDiv = document.getElementById("report");

function daily() {
  reportDiv.innerHTML = "";
  const bills = JSON.parse(localStorage.getItem(CLOSED_KEY)) || [];
  const today = new Date().toDateString();
  let total = 0;

  bills.filter(b => new Date(b.time).toDateString() === today)
    .forEach(b => {
      total += b.total;
      reportDiv.innerHTML += `
        <div class="row">
          <span>Table ${b.table}</span>
          <span>â‚¹${b.total}</span>
        </div>`;
    });

  reportDiv.innerHTML += `<hr><b>Total: â‚¹${total}</b>`;
}

function monthly() {
  reportDiv.innerHTML = "";
  const bills = JSON.parse(localStorage.getItem(CLOSED_KEY)) || [];
  const m = new Date().getMonth();
  let total = 0;

  bills.filter(b => new Date(b.time).getMonth() === m)
    .forEach(b => total += b.total);

  reportDiv.innerHTML = `<b>This Month Total: â‚¹${total}</b>`;
}

function logout() {
  localStorage.removeItem("admin_auth");
  localStorage.removeItem("admin_auth_time");
  location.href = "admin-login.html";
}
</script>

</body>
</html>
